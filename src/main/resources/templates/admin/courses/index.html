<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head th:insert="~{layouts/dashboard/head :: head}"></head>

<body class="admin-layout">
<div class="layout-wrapper">
    <aside th:insert="~{layouts/dashboard/sidebar :: nav}"></aside>

    <div class="layout-container">
        <header th:insert="~{layouts/dashboard/header :: header}"></header>

        <main class="main-content">
            <div class="content-header d-flex flex-column flex-md-row justify-content-between align-items-md-center gap-3">
                <div>
                    <h1 class="page-title">Quản lý Khóa học / Đào tạo</h1>
                    <p class="page-subtitle">Quản lý các khóa học, chương trình đào tạo</p>
                </div>
                <div class="d-flex gap-2">
                    <form th:action="@{/admin/courses}" method="get" class="d-flex">
                        <div class="input-group">
                            <input type="text" class="form-control" name="keyword"
                                   th:value="${keyword}" placeholder="Tìm kiếm khóa học...">
                            <button class="btn btn-secondary" type="submit">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </form>
                    <a th:href="@{/admin/courses/new}" class="btn btn-primary text-nowrap">
                        <i class="fas fa-plus"></i> Thêm khóa học
                    </a>
                </div>
            </div>

            <div class="card">
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-hover align-middle mb-0">
                            <thead class="bg-light">
                            <tr>
                                <th style="width: 80px;" class="text-center">Ảnh</th>
                                <th>Tên khóa học</th>
                                <th>Danh mục</th>
                                <th>Thông tin</th>
                                <th class="text-center">Trạng thái</th>
                                <th class="text-end">Hành động</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:if="${courses.isEmpty()}">
                                <td colspan="6" class="text-center py-4 text-muted">
                                    <i class="fas fa-box-open fa-2x mb-2"></i>
                                    <p>Không tìm thấy khóa học nào.</p>
                                </td>
                            </tr>
                            <tr th:each="course : ${courses}">
                                <td class="text-center">
                                    <img th:src="${course.thumbnailUrl != null ? course.thumbnailUrl : 'https://via.placeholder.com/50'}"
                                         class="thumbnail-sm" alt="Thumbnail">
                                </td>
                                <td>
                                    <div class="fw-bold" th:text="${course.name}">Tên khóa học</div>
                                    <small class="text-muted" th:text="${course.slug}">slug-khoa-hoc</small>
                                </td>
                                <td>
                                    <span class="badge bg-info text-dark"
                                          th:if="${course.category != null}"
                                          th:text="${course.category.name}">Danh mục</span>
                                    <span class="text-muted fst-italic" th:unless="${course.category != null}">Chưa phân loại</span>
                                </td>
                                <td>
                                    <div style="font-size: 13px;">
                                        <div><i class="fas fa-clock me-1 text-muted"></i> <span th:text="${course.duration}">--</span></div>
                                        <div><i class="fas fa-users me-1 text-muted"></i> <span th:text="${course.targetAudience}">--</span></div>
                                        <div><i class="fas fa-laptop-house me-1 text-muted"></i> <span th:text="${course.trainingFormat}">--</span></div>
                                    </div>
                                </td>
                                <td class="text-center">
                                    <span th:if="${course.isActive}" class="badge badge-status-published">Hoạt động</span>
                                    <span th:unless="${course.isActive}" class="badge badge-status-hidden">Ẩn</span>
                                </td>
                                <td class="text-end">
                                    <div class="btn-group">
                                        <a th:href="@{/admin/courses/detail/{id}(id=${course.id})}"
                                           class="btn btn-sm btn-info text-white" title="Xem chi tiết">
                                            <i class="fas fa-eye"></i>
                                        </a>

                                        <a th:href="@{/admin/courses/edit/{id}(id=${course.id})}"
                                           class="btn btn-sm btn-warning" title="Sửa">
                                            <i class="fas fa-edit"></i>
                                        </a>

                                        <a th:href="@{/admin/courses/delete/{id}(id=${course.id})}"
                                           class="btn btn-sm btn-danger"
                                           onclick="return confirmDelete('Xác nhận xóa?', 'Bạn có chắc chắn muốn xóa khóa học này không?')"
                                           title="Xóa">
                                            <i class="fas fa-trash"></i>
                                        </a>
                                    </div>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card-footer d-flex justify-content-between align-items-center" th:if="${totalPages > 1}">
                    <div class="text-muted small">
                        Hiển thị <span th:text="${courses.size()}"></span> / <span th:text="${totalItems}"></span> kết quả
                    </div>
                    <nav aria-label="Page navigation">
                        <ul class="pagination pagination-sm mb-0">
                            <li class="page-item" th:classappend="${currentPage == 0 ? 'disabled' : ''}">
                                <a class="page-link" th:href="@{/admin/courses(page=${currentPage - 1}, keyword=${keyword})}">
                                    <i class="fas fa-chevron-left"></i>
                                </a>
                            </li>

                            <li class="page-item" th:each="i : ${#numbers.sequence(0, totalPages - 1)}"
                                th:classappend="${currentPage == i ? 'active' : ''}">
                                <a class="page-link" th:href="@{/admin/courses(page=${i}, keyword=${keyword})}" th:text="${i + 1}">1</a>
                            </li>

                            <li class="page-item" th:classappend="${currentPage == totalPages - 1 ? 'disabled' : ''}">
                                <a class="page-link" th:href="@{/admin/courses(page=${currentPage + 1}, keyword=${keyword})}">
                                    <i class="fas fa-chevron-right"></i>
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </main>
    </div>
</div>

<div th:insert="~{layouts/dashboard/scripts :: scripts}"></div>
</body>
</html>